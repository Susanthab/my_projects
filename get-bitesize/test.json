{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "s3:GetObject"
            ],
            "Resource": [
                "arn:aws:s3:::bitesize-dev/us-west-2/ubathsu/cacerts/ca.pem"
            ]
        },
        {
            "Effect": "Allow",
            "Action": [
                "s3:GetObject",
                "s3:ListObjects",
                "s3:ListBucket",
                "s3:GetObjectVersion",
                "s3:PutObject",
                "s3:GetBucketLocation"
            ],
            "Resource": [
                "arn:aws:s3:::bitesize-dev",
                "arn:aws:s3:::bitesize-dev/us-west-2/ubathsu/",
                "arn:aws:s3:::bitesize-dev/us-west-2/ubathsu/files/stackstorm",
                "arn:aws:s3:::bitesize-dev/us-west-2/ubathsu/files/stackstorm/*",
                "arn:aws:s3:::bitesize-dev/us-west-2/ubathsu/backups/stackstorm",
                "arn:aws:s3:::bitesize-dev/us-west-2/ubathsu/backups/stackstorm/*"
            ]
        },
        {
            "Effect": "Allow",
            "Action": [
                "ec2:*"
            ],
            "Resource": [
                "*"
            ]
        },
        {
            "Effect": "Allow",
            "Action": [
                "cloudformation:*"
            ],
            "Resource": [
                "*"
            ]
        },
        {
            "Effect": "Allow",
            "Action": [
                "iam:CreateRole",
                "iam:ListGroups",
                "iam:ListUsers",
                "iam:ListRoles",
                "iam:ListInstanceProfiles",
                "iam:ListPolicies",
                "iam:ListRolePolicies",
                "iam:GetRolePolicy",
                "iam:PutRolePolicy",
                "iam:PassRole",
                "iam:CreateInstanceProfile",
                "iam:CreatePolicy",
                "iam:AttachRolePolicy",
                "iam:DeleteInstanceProfile",
                "iam:AddRoleToInstanceProfile",
                "iam:ListInstanceProfilesForRole",
                "iam:RemoveRoleFromInstanceProfile",
                "iam:DeleteRolePolicy",
                "iam:DeleteRole"
            ],
            "Resource": "*"
        },
        {
            "Effect": "Allow",
            "Action": [
                "rds:*"
            ],
            "Resource": [
                "*"
            ]
        },
        {
            "Effect": "Allow",
            "Action": [
                "kms:*"
            ],
            "Resource": [
                "*"
            ]
        },
        {
            "Effect": "Allow",
            "Action": [
                "es:*"
            ],
            "Resource": [
                "*"
            ]
        },
        {
            "Effect": "Allow",
            "Action": [
                "sns:*"
            ],
            "Resource": [
                "*"
            ]
        },
        {
            "Effect": "Allow",
            "Action": [
                "elasticache:*"
            ],
            "Resource": [
                "*"
            ]
        },
        {
            "Effect": "Allow",
            "Action": [
                "route53:*"
            ],
            "Resource": [
                "*"
            ]
        },
        {
            "Effect": "Allow",
            "Action": [
                "ses:*"
            ],
            "Resource": [
                "*"
            ]
        },
        {
            "Effect": "Allow",
            "Action": [
                "elasticloadbalancing:*"
            ],
            "Resource": [
                "*"
            ]
        },
        {
            "Effect": "Allow",
            "Action": [
                "autoscaling:*"
            ],
            "Resource": [
                "*"
            ]
        },
        {
            "Effect": "Allow",
            "Action": [
                "ssm:PutParameter",
                "ssm:GetParameter",
                "ssm:AddTagsToResource"
            ],
            "Resource": [
                "arn:aws:ssm:*:*:parameter/tpr-dev/database/*"
            ]
        }
    ]
}

{
    "Effect": "Allow",
    "Action": [ "ssm:PutParameter", "ssm:AddTagsToResource" ],
    "Resource": [ "arn:aws:ssm:*:*:parameter/*/database/*" ]
},

{
    "Version":"2012-10-17",
    "Statement":[
       {
          "Effect":"Allow",
          "Action":[
             "ssm:GetParameters",
          ],
          "Resource":"*",
          "Condition":{
             "StringLike":{
                "ssm:resourceTag/t_role":[
                   "database"
                ]
             }
          }
       }
    ]
 }


 {"Version":"2012-10-17","Statement":[{"Effect":"Allow","Action":["autoscaling:Describe*","ec2:Describe*","elasticfilesystem:Describe*","logs:DescribeResourcePolicies"],"Resource":"*"},{"Effect":"Allow","Action":["ssm:GetParameter"],"Resource": "arn:aws:ssm:<% $.region %>:<% $.account_id %>:parameter/*/database/couchbase/*"},{"Effect":"Allow","Action":["ssm:SendCommand"],"Resource": "arn:aws:ec2:<% $.region %>:<% $.account_id %>:instance/*","Condition": {"StringEquals":{"ec2:ResourceTag/DB_system":"couchbase"}}},{"Effect":"Allow","Action":["s3:PutObject","s3:GetObject"],"Resource":["arn:aws:s3:::<% $.s3_bucket_name %>"]}]}



 {
    "Version":"2012-10-17",
    "Statement":[
       {
          "Effect":"Allow",
          "Action":[
             "autoscaling:Describe*",
             "ec2:Describe*",
             "elasticfilesystem:Describe*",
             "logs:DescribeResourcePolicies"
          ],
          "Resource":"*"
       },
       {
          "Effect":"Allow",
          "Action":[
             "ssm:GetParameter"
          ],
          "Resource":"arn:aws:ssm:<% $.region %>:<% $.account_id %>:parameter/*/database/couchbase/*"
       },
       {
          "Effect":"Allow",
          "Action":[
             "ssm:SendCommand"
          ],
          "Resource":"arn:aws:ec2:<% $.region %>:<% $.account_id %>:instance/*",
          "Condition":{
             "StringEquals":{
                "ec2:ResourceTag/DB_system":"couchbase"
             },
             "StringEquals":{
                "ec2:ResourceTag/Deployment_name":"<% $.deployment_name %>"
             }
          }
       },
       {
          "Effect":"Allow",
          "Action":[
             "s3:PutObject",
             "s3:GetObject"
          ],
          "Resource":[
             "arn:aws:s3:::<% $.s3_bucket_name %>"
          ]
       }
    ]
 }





 


<% '{"Version":"2012-10-17","Statement":[{"Effect":"Allow","Action":["autoscaling:Describe*","ec2:Describe*","elasticfilesystem:Describe*","logs:DescribeResourcePolicies"],"Resource":"*"},{"Effect":"Allow","Action":["ssm:GetParameter"],"Resource":"arn:aws:ssm:' + $.region + ':' + $.account_id + ':parameter/*/database/couchbase/*"},{"Effect":"Allow","Action":["ssm:SendCommand"],"Resource":"arn:aws:ec2:' + $.region + ':' + $.account_id + ':instance/*","Condition": {"StringEquals": {"ec2:ResourceTag/DB_system":["<% $.DB_system %>"],"ec2:ResourceTag/Deployment_name":["<% $.deployment_name %>"]}}},{"Effect":"Allow","Action":["s3:PutObject","s3:GetObject"],"Resource":["arn:aws:s3:::' + $.s3_bucket_name + '/*"]}]}' %>