TASK [ansible-couchbase/roles/couchbase-configure : Execute the configure_cb_cluster script] ***
fatal: [localhost]: FAILED! => {"changed": true, "cmd": ["sh", "/usr/local/bin/configure_cb_cluster.sh"], "delta": "6:12:20.929485", "end": "2018-06-22 13:49:56.666517", "msg": "non-zero return code", "rc": -11, "start": "2018-06-22 07:37:35.737032", "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": []}



Current user and path
root
/etc/ansible
INFO: RAM Available (KB) - 65948
INFO: Memory allocated to Couchbase (MB) - 49461
INFO: Data RAM Quota (MB) - 37096
INFO: Index RAM Quota (MB) - 7419
Cluster RAM size: 37096
Cluster Index RAM size: 7419

INFO: check to see whether SSM agent is running...
**************************************************
Status: (running)
 is running!!!
INFO: Get AWS metadata...
EC2_AVAIL_ZONE: us-west-2b
EC2_REGION: us-west-2
INSTANCE_ID: i-032e6a1d83035fc07
CURRENT_NODE_IP: 10.240.45.128
AG_NAME: couchbase-glp1-prod-glp-prd-analytics

----------------------
| STEP 01 - Get tags.|
----------------------
INFO: Cluster type: standard
INFO: Node service offering: 
INFO: Cluster name: analytics-glp-prd
INFO: t_environment: glp-prd
INFO: t_role: database
INFO: DB_system: couchbase
INFO: Deployment_name: analytics
INFO: All the instances of the cluster: i-032e6a1d83035fc07	i-0b0a3ea9d9bc17286	i-0c500da44b73c5dbd	i-0c81d8493c86db17e	i-0df728994683fb7a5

--------------------------------------------
| STEP 02 - Wait for all the EC2 instances.|
--------------------------------------------

----------------------------------------
| STEP 03 - Wait for couchbase servers.|
----------------------------------------
INFO: Status of the server, 10.240.45.128: healthy

----------------------------------------------------
| STEP 04 - Initializes the node, 10.240.45.128 |
----------------------------------------------------
OUTPUT: node-init: SUCCESS: Node initialized

---------------------------------------
| STEP 05 - Identify a primary server.|
---------------------------------------
INFO: Service type is: standard
INFO: Service offering of the node: 
OUTPUT: server-list: 10.240.45.128 - 

OUTPUT: server-list: 10.240.50.166 - ns_1@127.0.0.1 10.240.50.166:8091 healthy active

INFO: Active server found in the cluster.
INFO: Primary server is-1: 10.240.50.166

--------------------------------------
| STEP 06 - Initializing the cluster.|
--------------------------------------
INFO: Designated primary server ip: 10.240.50.166
OUTPUT: cluster-init: SUCCESS: Cluster initialized
OUTPUT: setting-cluster (cluster name): SUCCESS: Cluster settings modified
OUTPUT: create-group: [True, None, None, None, None]
SUCCESS: Server group created
OUTPUT: move-group: [None, None, None, None, '10.240.45.128']
SUCCESS: Servers moved between groups

------------------------
| STEP 07 - Add server.|
------------------------
INFO: Service offering of the node: 
OUTPUT: create-group: [True, None, None, None, None]
ERROR: name - already exists
OUTPUT: server-add: ERROR: Prepare join failed. Node is already part of cluster.
INFO: Checking whether server is added to the cluster...
OUTPUT: host-list: 
INFO: Service offering of the node:

==================================

Current user and path
root
/etc/ansible
INFO: RAM Available (KB) - 65948
INFO: Memory allocated to Couchbase (MB) - 49461
INFO: Data RAM Quota (MB) - 37096
INFO: Index RAM Quota (MB) - 7419
Cluster RAM size: 37096
Cluster Index RAM size: 7419

INFO: check to see whether SSM agent is running...
**************************************************
Status: (running)
 is running!!!
INFO: Get AWS metadata...
EC2_AVAIL_ZONE: us-west-2a
EC2_REGION: us-west-2
INSTANCE_ID: i-0c81d8493c86db17e
CURRENT_NODE_IP: 10.240.33.210
AG_NAME: couchbase-glp1-prod-glp-prd-analytics

----------------------
| STEP 01 - Get tags.|
----------------------
INFO: Cluster type: standard
INFO: Node service offering: 
INFO: Cluster name: analytics-glp-prd
INFO: t_environment: glp-prd
INFO: t_role: database
INFO: DB_system: couchbase
INFO: Deployment_name: analytics
INFO: All the instances of the cluster: i-032e6a1d83035fc07	i-0b0a3ea9d9bc17286	i-0c500da44b73c5dbd	i-0c81d8493c86db17e	i-0df728994683fb7a5

--------------------------------------------
| STEP 02 - Wait for all the EC2 instances.|
--------------------------------------------

----------------------------------------
| STEP 03 - Wait for couchbase servers.|
----------------------------------------
INFO: Status of the server, 10.240.33.210: healthy

----------------------------------------------------
| STEP 04 - Initializes the node, 10.240.33.210 |
----------------------------------------------------
OUTPUT: node-init: SUCCESS: Node initialized

---------------------------------------
| STEP 05 - Identify a primary server.|
---------------------------------------
INFO: Service type is: standard
INFO: Service offering of the node: 
OUTPUT: server-list: 10.240.45.128 - 

OUTPUT: server-list: 10.240.50.166 - 

OUTPUT: server-list: 10.240.33.37 - 

OUTPUT: server-list: 10.240.33.210 - 

OUTPUT: server-list: 10.240.42.206 - 

INFO: Primary server is-2: 10.240.45.128

--------------------------------------
| STEP 06 - Initializing the cluster.|
--------------------------------------
INFO: Designated primary server ip: 10.240.45.128
OUTPUT: cluster-init: SUCCESS: Cluster initialized
OUTPUT: setting-cluster (cluster name): SUCCESS: Cluster settings modified
OUTPUT: create-group: [True, None, None, None, None]
SUCCESS: Server group created
OUTPUT: move-group: [None, None, None, None, '10.240.33.210']
SUCCESS: Servers moved between groups

------------------------
| STEP 07 - Add server.|
------------------------
INFO: Service offering of the node: 
OUTPUT: create-group: ERROR: Cluster is not initialized, use cluster-init to initialize the cluster
OUTPUT: server-add: ERROR: Cluster is not initialized, use cluster-init to initialize the cluster
INFO: Checking whether server is added to the cluster...
OUTPUT: host-list: 
INFO: Service offering of the node: 
OUTPUT: create-group: ERROR: Cluster is not initialized, use cluster-init to initialize the cluster
OUTPUT: server-add: ERROR: Cluster is not initialized, use cluster-init to initialize the cluster
INFO: Checking whether server is added to the cluster...
OUTPUT: host-list: 
INFO: Service offering of the node: 
OUTPUT: create-group: ERROR: Cluster is not initialized, use cluster-init to initialize the cluster
OUTPUT: server-add: ERROR: Cluster is not initialized, use cluster-init to initialize the cluster
INFO: Checking whether server is added to the cluster...
OUTPUT: host-list: 
INFO: Service offering of the node: 
OUTPUT: create-group: ERROR: Cluster is not initialized, use cluster-init to initialize the cluster
OUTPUT: server-add: ERROR: Cluster is not initialized, use cluster-init to initialize the cluster
INFO: Checking whether server is added to the cluster...
OUTPUT: host-list: 
INFO: Service offering of the node: 
OUTPUT: create-group: [True, None, None, None, None]
SUCCESS: Server group created
OUTPUT: server-add: SUCCESS: Server added
INFO: Checking whether server is added to the cluster...
OUTPUT: host-list: 10.240.33.210:8091

------------------------------------
| STEP 08 - Remove unhealthy nodes.|
------------------------------------

-----------------------
| STEP 09 - Rebalance.|
-----------------------
INFO: Status of the server, 10.240.33.210: healthy
OUTPUT: cluster rebalance: Unable to display progress bar on this os
SUCCESS: Rebalance complete